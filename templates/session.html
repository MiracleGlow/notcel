{% extends "layout.html" %}

{% block title %}Sesi: {{ session_name }} - SesiPad{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div class="d-flex align-items-center">
        <a href="{{ url_for('index') }}" class="btn btn-sm btn-outline-secondary me-3">
            <i class="bi bi-arrow-left"></i>
        </a>
        <h1 class="h3 mb-0 text-break">Sesi: <span class="fw-bold">{{ session_name }}</span></h1>
    </div>
</div>


<!-- Upload file tambahan ke sesi ini -->
<div class="card mb-4">
    <div class="card-body">
        <h5 class="card-title">Tambah File ke Sesi</h5>
        <form method="POST" action="{{ url_for('upload_to_session', session_name=session_name) }}" enctype="multipart/form-data">
            <div class="input-group">
                <input type="file" class="form-control" name="file" required>
                <button class="btn btn-primary" type="submit">
                    <i class="bi bi-upload me-1"></i> Upload
                </button>
            </div>
            <div class="form-text mt-2">Ukuran file maksimal yang disarankan adalah 4 MB.</div>
        </form>
    </div>
</div>


{% if files %}
  <div class="list-group">
    {% for f in files %}
      <div class="list-group-item p-3">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <strong class="text-break">{{ f.name }}</strong>
          <a class="btn btn-sm btn-outline-secondary" href="{{ f.url }}" download>
            <i class="bi bi-download me-1"></i> Download
          </a>
        </div>
        <div class="file-preview-wrapper">
            {% if f.kind == 'image' %}
              <img src="{{ f.url }}" class="img-fluid" alt="{{ f.name }}">
            {% elif f.kind == 'video' %}
              <video controls class="w-100"><source src="{{ f.url }}" {% if f.mimetype %}type="{{ f.mimetype }}"{% endif %}></video>
            {% elif f.kind == 'audio' %}
              <audio controls class="w-100"><source src="{{ f.url }}" {% if f.mimetype %}type="{{ f.mimetype }}"{% endif %}></audio>
            {% elif f.kind == 'text' %}
              <pre class="mb-0"><code>{{ f.text }}</code></pre>
            {% else %}
              <p class="text-muted mb-0 fst-italic">Pratinjau tidak tersedia untuk format file ini.</p>
            {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
    <div class="text-center p-5 border rounded">
        <p class="text-muted fs-5">Belum ada file di sesi ini.</p>
        <p>Gunakan form di atas untuk mulai mengunggah.</p>
    </div>
{% endif %}

{% endblock %}